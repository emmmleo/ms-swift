# ✨ AI魔法工坊 WebUI 使用指南

这是一个基于 Swift 框架深度定制的 WebUI，旨在提供“模型训练云服务”体验。它采用了全新的卡通风格 UI 设计，并支持**前后端分离架构**，允许将 Web 界面部署在公网服务器，而将繁重的训练任务调度到内网 GPU 服务器执行。

## 🌟 核心特性

*   **云服务架构**：Web 前端与 GPU 训练后端解耦，通过 HTTP API 通信。
*   **全新 UI 设计**：采用侧边栏导航和清爽的卡通风格，移除复杂的框架术语，更适合终端用户。
*   **远程任务管理**：直接在 Web 界面查看远程 GPU 服务器上的任务列表、实时日志，并可一键终止进程。
*   **低资源前端**：Web 服务端仅需 CPU 即可运行，节省昂贵的 GPU 实例用于计算。

---

## 🚀 部署指南

本系统分为 **GPU 训练后端** 和 **Web 前端** 两部分。

### 1. 部署 GPU 训练后端 (Backend)

在拥有 GPU 显卡的服务器上运行，负责实际的模型训练。

**前置要求**：
*   Python 环境
*   已安装 Swift 框架及相关依赖
*   安装 Agent 依赖：`pip install fastapi uvicorn psutil`

**启动命令**：
```bash
# 在 ms-swift 项目根目录下运行
python swift/ui/agent.py
```
> 💡 **提示**：建议使用 `nohup` 或 `screen` 让服务在后台常驻运行。服务默认监听 `0.0.0.0:8000`。

### 2. 部署 Web 前端 (Frontend)

在面向用户的 Web 服务器（如阿里云 ECS、轻量应用服务器）上运行。

**前置要求**：
*   Python 环境
*   安装 Swift 框架（主要用于 UI 渲染）
*   安装请求库：`pip install requests`

**启动命令**：
你需要通过环境变量 `SWIFT_REMOTE_WORKER` 指定 GPU 后端的地址。

```bash
# 替换 <GPU_SERVER_IP> 为后端服务器的公网 IP 或内网 IP
export SWIFT_REMOTE_WORKER="http://<GPU_SERVER_IP>:8000"

# 启动 WebUI
python swift/ui/app.py
```

访问终端输出的 URL（通常是 `http://127.0.0.1:7860` 或公网 IP:7860）即可开始使用。

---

## 📖 使用说明

1.  **启动训练**：
    *   在左侧菜单选择“LLM 训练”或“RLHF 训练”。
    *   配置模型参数、数据集和训练参数。
    *   点击底部的“开始训练”按钮。
    *   WebUI 会自动将命令发送给远程 GPU 服务器。

2.  **查看日志**：
    *   点击“运行时” (Runtime) 菜单。
    *   在“运行中任务”下拉框中选择刚才启动的任务。
    *   点击“展示运行状态”，即可实时看到远程服务器传回的训练日志和 TensorBoard 图表。

3.  **管理任务**：
    *   在“运行时”页面，点击“找回运行时任务”可刷新远程任务列表。
    *   选中任务后，点击“杀死任务”可远程终止该训练进程。

---

## 🛠️ 常见问题

**Q: 前端显示“Failed to connect to remote worker”怎么办？**
A: 请检查：
1.  GPU 后端的 `agent.py` 是否正在运行。
2.  GPU 服务器的防火墙/安全组是否开放了 `8000` 端口。
3.  前端服务器是否能 ping 通 GPU 服务器 IP。

**Q: 本地开发如何测试？**
A: 如果不设置 `SWIFT_REMOTE_WORKER` 环境变量，WebUI 将默认在本地模式下运行，即训练任务和 Web 服务在同一台机器上执行。
